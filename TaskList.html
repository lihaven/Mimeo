<html>
<head>
<link rel="stylesheet" href="bootstrap/bootstrap.min.css">
<script type"text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type"text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
<!--
http://www.colourlovers.com/wedding/trends/wedding-invites/7891/Winter_Wonderland
#DDD8D5 - White Sand
#E4E4E6 - 669~metric gen 2^3 (Snow)
#9FA9A0 - Vintage Feel (Pale Green)
#91966E - Sometime Green (Slightly Forest Green)
#BCAD90 - FW Oxidized Cream (Light Brown)
-->
<style> 
body {
    background:#DDD8D5;
}

.main {
    background:#E4E4E6;
    margin:72px;
    padding-top:72px;
    padding-bottom:72px;
    padding-left:72px;
    padding-right:72px;
}

ul {
    list-style:none;
}

.ui-sortable-helper {
    background-color:#9FA9A0;
    list-style:none;
}

.task {
    background-color:#91966E;
    margin:10px;
    padding:5px;
}

.done {
    background-color:#DDD8D5;
    color:#91966E;
}

.list-control {
    text-align:right;
    margin:10px;
}


</style>


</head>
<body>


<div class="main">
    <h1>Task List</h1>

    <script>
        $(function() {
            //make list sortable
            $( "ul" ).addClass("sortable");
            $( ".sortable" ).sortable({
                items: "li:not(.done)"
            });
            $( ".sortable" ).disableSelection();
            format( $( "li" ) );
            
            //Listener for when the new task button
            $( ".add" ).click(function() {
                var li = $( '<li> <span class="comp"><input type="checkbox"></span>'+ 
                            '<span class="desc">NewTask 7</span>'+
                            '<span class="task-btns"></span></li>');
                $( ".main-list" ).append( li );
                format( li );
            });
           
            //Listener for the delete buttons 
            $( ".main-list" ).delegate( ".del", "click", function() {
                $(this).closest('li').detach();
            });


            //When an edit button on the task is clicked, allow the user to 
            //change the description.
            //could probalby just use the main obj instead of getting btn
            $( ".main-list" ).delegate( ".edit", "click", function() {
                var obj = $(this).closest("li").find(".desc");
                var btn = $(this).closest("li").find(".edit");
                if (!btn.hasClass("btn-primary")) { //don't do again on primary btn
                    var desc = obj.html();
                    obj.html('<input class="new-desc" type="text" value="'+desc+'">');
                    obj.closest("li").find(".edit").addClass("btn-primary");
                }
            });

            //When a task description is editable and the primary button is pressed,
            //save the new value and down grade button status. 
            $( ".main-list" ).delegate( ".btn-primary", "click", function() {
                var obj = $(this).closest("li");
                var desc = obj.find(".new-desc").val();
                obj.find(".desc").html(desc);
                obj.find(".edit").removeClass("btn-primary");
                console.log(obj.closest("li"));
            });
           
            //Listener: When complete checkbox is modified, format appropriately
            $( ".main-list" ).delegate( ".check", "click", function() {
                if ($(this).is(':checked')) {
                    ($(this).closest("li")).addClass("done").disableSelection();
                }
                else {
                    ($(this).closest("li")).removeClass("done");
                }
            });
             
            //Adds task formating and buttons to specified li element
            function format(li) {
                li.addClass("task");
                li.find(".task-btns").append(
                    '<a href="#" class="btn del"><i class="icon-minus"></i></a>' + 
                    '<a href="#" class="btn edit"><i class="icon-edit"></i></a>'
                  );
            }

            //Formats a completed task
            function formatComplete(li) {
                li.addClass("done");
            }

        });
    </script>

    <div class="list-control">
        <a href="#" class="btn add"><i class="icon-plus"></i></a>
        <a href="#" class="btn del"><i class="icon-minus"></i></a>
        <a href="#" class="btn edit"><i class="icon-edit"></i></a>
    </div>

    <div class="list-portal">
        <ul class="main-list">
            <li> <span class="comp"><input class="check done" type="checkbox"></span>  <span class="desc">Task list</span>               <span class="task-btns"></span></li>
            <li> <span class="comp"><input class="check" type="checkbox"></span>  <span class="desc">Task list is sortable</span>   <span class="task-btns"></span></li>
            <li> <span class="comp"><input class="check" type="checkbox"></span>  <span class="desc">Tasks can be added</span>      <span class="task-btns"></span></li> 
            <li> <span class="comp"><input class="check" type="checkbox"></span>  <span class="desc">Tasks can be deleted</span>    <span class="task-btns"></span></li> 
            <li> <span class="comp"><input class="check" type="checkbox"></span>  <span class="desc">Descriptions editable</span>   <span class="task-btns"></span></li> 
            <li> <span class="comp"><input class="check" type="checkbox"></span>  <span class="desc">Mark tasks as complete</span>  <span class="task-btns"></span></li>
        </ul>
    </div>
</div>
</body>
</html>
